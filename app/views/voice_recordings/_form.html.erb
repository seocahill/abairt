<%= form_with(model: voice_recording, class: "contents", html: { multipart: true }, data: { turbo: false }) do |form| %>
  <% if voice_recording.errors.any? %>
    <div id="error_explanation" class="bg-red-50 text-red-500 px-3 py-2 font-medium rounded-lg mt-3">
      <h2><%= pluralize(voice_recording.errors.count, "error") %> prohibited this voice_recording from being saved:</h2>

      <ul>
        <% voice_recording.errors.each do |error| %>
          <li><%= error.full_message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="my-5">
    <%= form.label :title %>
    <%= form.text_field :title, class: "block shadow rounded-md border border-gray-200 outline-none px-3 py-2 mt-2 w-full", required: true %>
  </div>

  <div class="my-5">
    <%= form.label :description %>
    <%= form.text_area :description, rows: 4, class: "block shadow rounded-md border border-gray-200 outline-none px-3 py-2 mt-2 w-full", required: true %>
  </div>

  <div class="my-5">
    <%= form.label :transcription %>
    <%= form.text_area :transcription, rows: 4, class: "block shadow rounded-md border border-gray-200 outline-none px-3 py-2 mt-2 w-full", placeholder: "Optionally add an existing transcription" %>
  </div>

  <div class="my-5">
    <%= form.label :transcription_en %>
    <%= form.text_area :transcription_en, rows: 4, class: "block shadow rounded-md border border-gray-200 outline-none px-3 py-2 mt-2 w-full", placeholder: "Optionally add an existing English transcription" %>
  </div>

  <%= render "media_upload", form: form %>

  <div class="my-5">
    <div class="flex items-start">
      <%= form.check_box :copyright_confirmation, { required: true, class: "mt-1 mr-3" }, "true", "" %>
      <%= form.label :copyright_confirmation, class: "text-sm text-gray-700" do %>
        I confirm that this media file does not violate copyright and contains the speech of North Connacht native Irish speakers (North Galway, Mayo, Sligo, Roscommon, Leitrim) <span class="text-red-500">*</span>
      <% end %>
    </div>
  </div>

  <div class="flex items-center gap-4">
    <%= form.submit class: "rounded-lg py-3 px-5 bg-blue-600 text-white inline-block font-medium cursor-pointer hover:bg-blue-700 transition-colors" %>
    
    <%= link_to 'Cancel', voice_recordings_path, class: "rounded-lg py-3 px-5 bg-gray-600 text-white inline-block font-medium cursor-pointer hover:bg-gray-700 transition-colors" %>
  </div>
<% end %>

<% if voice_recording.persisted? && policy(voice_recording).destroy? %>
  <div class="mt-6 pt-6 border-t border-gray-200">
    <div class="flex items-center justify-between">
      <div class="text-sm text-gray-600">
        <strong>Danger Zone</strong>
        <p class="text-xs text-gray-500 mt-1">This action cannot be undone.</p>
      </div>
      <%= button_to 'Delete Recording', voice_recording_path(voice_recording), 
          method: :delete, 
          class: "rounded-lg py-3 px-5 bg-red-600 text-white inline-block font-medium cursor-pointer hover:bg-red-700 transition-colors",
          form: { 
            data: { 
              turbo: false,
              controller: "confirm",
              confirm_message_value: 'Are you sure you want to delete this voice recording? This action cannot be undone.' 
            } 
          } %>
    </div>
  </div>
<% end %>
